<%define "addsubject"%>
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
    <title>府谷交警内网后台管理程序</title>
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Cache-Control" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <meta name="description" content="府谷交警 内网">
    <link rel="shortcut icon" href="/images/1.ico" type="image/x-icon" />
    <link rel="stylesheet" type="text/css" href="/css/houtai.css">
    <link rel="stylesheet" type="text/css" href="/js/webuploader/webuploader.css">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="Content-Language" content="zh-cn">
    <meta http-equiv="imagetoolbar" content="false">
    <script type="text/javascript" src="/js/ku/jquery.min.js"></script>
    <script type="text/javascript" src="/js/ku/jquery.SuperSlide.2.1.1.js"></script>
   
    <!--[if IE 6]>
<script src="DD_belatedPNG.js"></script>
<script>
  DD_belatedPNG.fix('.phoneicon');
</script>
<![endif]-->

    <body ms-controller="fugujiaojing" id="homefirst">
        <div id="wrapper">
            <%template "header" .%>
            <div id="maincontent">
            

                <div class="idea divclass" id="d1">
                    <%if .Modify%>
                    <h2>修改专题</h2>
                    <%else%>
                    <h2>增加专题</h2>
                    <%end%>
                </div>
                
                    <%if .Modify%>
                    <form action="/admin/modifySubject" method="post" enctype="multipart/form-data"   onsubmit="return CheckPost();">
                        <input type="hidden" name="id" value="<%.Id%>">
                    <div class="idea clearboder" id="d1" style="padding-top: 10px;padding-left:60px">
                        专题名 <span style="color: red">*</span>
                        <input style="vertical-align: middle; margin-left: 3em;height:40px;line-height: 38px;padding-left:1em;padding-right:1em;border: 1px solid #aaa;width: 17em;" type="text" name="subjectName" value="<%.Name%>"> <span style="margin-left: 2em;color: gray">
                    </div>
                   
                    <div class="idea clearboder" id="d1" style="padding-top: 10px;padding-left:60px">
                        主要专题 <span style="color: white">*</span>
                       &nbsp;
                        <input type="checkbox" style="border: none;vertical-align: middle; margin-left: 2em;height:40px;line-height: 38px;padding-left:1em;padding-right:1em;" name="isHot" value="true" <%if eq .IsHot "true"%>checked='checked'<%end%>>
                    </div>
                   
                    <div class="idea clearboder" id="d1" style="padding-top: 10px;padding-left:60px">
                        专题图片 &nbsp;<input id="imagename" type="hidden" style="vertical-align: middle; margin-left: 2em;height:40px;line-height: 38px;padding-left:1em;padding-right:1em;border: 1px solid  #aaa;width: 22em;" name="pic" value="<%.Pic%>">
                        <span id="picker" style="display: inline-block;vertical-align: middle;margin-left: 2em;width: 8em!important">上传</span> 
                        <span id="chakan" style="vertical-align: middle;margin-left: 2em;width: 54px;height: 42px;line-height: 42px;border-radius: 3px;color: white;text-align: center;background-color: #3cc24c;;cursor: pointer;display: none;">查看图片</span>
                     
                        <div id="chakan" style="vertical-align: middle;margin-left: 2em;height: 42px;line-height: 42px;border-radius: 3px;color: gray;text-align: left;">提示：普通专题请选用长宽比为 <span style="color: red">5.3</span> 的图片(如：<span style="color: red">342*65</span>),主要专题请选用长宽比为11.5的图片(如：<span style="color: red">1090*95</span>)</div>
                    </div>
                           <script type="text/javascript">
                           $("#chakan").click(function(){
                                window.open("<%.Pic%>")
                            })
                        </script>

                    </div>
                    
                    <%else%>
                    
                    <form action="/admin/addSubject" method="post" name="dep" enctype="multipart/form-data"   onsubmit="return CheckPost();">
                     <div class="idea clearboder" id="d1" style="padding-top: 10px;padding-left:60px">
                        专题名 <span style="color: red">*</span>
                        <input style="vertical-align: middle; margin-left: 3em;height:40px;line-height: 38px;padding-left:1em;padding-right:1em;border: 1px solid #aaa;width: 17em;" type="text" name="subjectName"> <span style="margin-left: 2em;color: gray">
                    </div>
                      <div class="idea clearboder" id="d1" style="padding-top: 10px;padding-left:60px">
                        主要专题 <span style="color: white">*</span>
                       &nbsp;
                        <input type="checkbox" style="border: none;vertical-align: middle; margin-left: 2em;height:40px;line-height: 38px;padding-left:1em;padding-right:1em;" name="isHot" value="true">
                    </div>
                   
                    <div class="idea clearboder" id="d1" style="padding-top: 10px;padding-left:60px">
                        专题图片 &nbsp;<input id="imagename" type="hidden" style="vertical-align: middle; margin-left: 2em;height:40px;line-height: 38px;padding-left:1em;padding-right:1em;border: 1px solid  #aaa;width: 22em;" name="pic" v>
                         <span id="picker" style="display: inline-block;vertical-align: middle;margin-left: 2em;width: 8em!important">上传</span> 
                        <span id="chakan" style="vertical-align: middle;margin-left: 2em;width: 54px;height: 42px;line-height: 42px;border-radius: 3px;color: white;text-align: center;background-color: #3cc24c;;cursor: pointer;display: none;">查看图片</span>

                        <div id="chakan" style="vertical-align: middle;margin-left: 2em;height: 42px;line-height: 42px;border-radius: 3px;color: gray;text-align: left;display: inline-block;">提示：普通专题请选用长宽比为 <span style="color: red">5.3</span> 的图片(如：<span style="color: red">342*65</span>),主要专题请选用长宽比为11.5的图片(如：<span style="color: red">1090*95</span>)</div>
                    </div>
                    </div>
                    <%end%>
                     <input style="width:80px;height: 40px;margin-top: 2em;margin-left: 57px;background-color: #fc8114;color: white;margin-bottom: 20px;cursor: pointer;" type="submit" name="提交" value="提交">
                    &emsp;&emsp;
                    <input style="width:80px;height: 40px;line-height: 40px;margin-top: 2em;margin-left: 57px;background-color: #CCC;color: white;margin-bottom: 20px;cursor: pointer;text-align: center;"  type="button"  name="取消" value="取消"  onclick="window.location.href='/admin/page/subject_list'">
                </form>
            </div>
                        </div>

            <div id="footer">
                <p id="p2">
                    <a style="color: #636161;font-size: 0.8em;" target="_blank" title="府谷县公安局交警大队">府谷县公安局交警大队版权所有 保留一切权利</a>
                    <a target="_blank"></a>
                </p>
            </div>
        </div>
        <script type="text/javascript" charset="utf-8"  src="/js/ku/jqueryMig.js"></script>
        <script type="text/javascript" charset="utf-8"  src="/js/webuploader/webuploader.js"></script>

</body>
    <script type="text/javascript">

       var cantijiao=false;
       var uploader = WebUploader.create({

            // 选完文件后，是否自动上传。
            auto: true,

            // swf文件路径
            swf: '/js/webuploader/Uploader.swf',

            // 文件接收服务端。
            server: '/uploadImage',

            // 选择文件的按钮。可选。
            // 内部根据当前运行是创建，可能是input元素，也可能是flash.
            pick: '#picker',
            fileVal:"upfile", 
            // 只允许选择图片文件。
            accept: {
                title: 'Images',
                extensions: 'gif,jpg,jpeg,bmp,png',
                mimeTypes: 'image/*'
            }
        });
        uploader.on( 'uploadSuccess', function(file, res) {
            alert("上传图片成功！")
            $("#imagename").val(res.url);
            $("#chakan").css('display','inline-block');
            $("#chakan").unbind();
            $("#chakan").click(function(){
                window.open(res.url)
            })
        });

            // 文件上传失败，显示上传出错。
        uploader.on( 'uploadError', function( file ) {
           alert("上传图片错误，请重新上传！")
        });

            // 完成上传完了，成功或者失败，先删除进度条。
        uploader.on( 'uploadComplete', function( file ) {

        });

         function myTrim(x) {
            return x.replace(/^\s+|\s+$/gm,'');
        }

         function CheckPost () {  
            dep.subjectName.value=myTrim(dep.subjectName.value);
            dep.imagename.value=myTrim(dep.imagename.value);
           
            if (myTrim(dep.subjectName.value) == "")
              {
                  alert("请专题标题！");
                  dep.title.focus();
                  return false;
              }
            if (myTrim(dep.imagename.value) == "")
              {
                  alert("请上传图片!");
                  return false;
              }
              
             return true;
           }

</script>

</html>
<%end%>